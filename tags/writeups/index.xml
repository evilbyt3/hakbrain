<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>writeups on</title><link>https://hakbrain.xyz/tags/writeups/</link><description>Recent content in writeups on</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 14 Sep 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://hakbrain.xyz/tags/writeups/index.xml" rel="self" type="application/rss+xml"/><item><title>Red Team Threat Intel</title><link>https://hakbrain.xyz/write-ups/thm/Red-Team-Threat-Intel/</link><pubDate>Wed, 14 Sep 2022 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/Red-Team-Threat-Intel/</guid><description>Threat Intelligence 101 Threat Intelligence (TI) or Cyber Threat Intelligence (CTI) is evidence-based knowledge about adversaries (including TTPs motivations, and actionable advice against them)</description></item><item><title>0. Hello Ethernaut</title><link>https://hakbrain.xyz/write-ups/ethernaut/hello_ethernaut/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/ethernaut/hello_ethernaut/</guid><description>help() to see functions get instance, check contract Solving 1 2 3 4 5 6 7 8 9 10 await contract.</description></item><item><title>2. Fallout</title><link>https://hakbrain.xyz/write-ups/ethernaut/fallout/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/ethernaut/fallout/</guid><description>![[write-ups/images/fallback_contract.png]]
notice that the constructor of the smart contract is misspelled: Fal1out() =&amp;gt; made available as a public function can be also seen in ABI: console.</description></item><item><title>4. CoinFlip</title><link>https://hakbrain.xyz/write-ups/ethernaut/coinflip/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/ethernaut/coinflip/</guid><description>used mythrill for static analysis on EVM bytecode: myth a CoinFlip.sol make sure you store your contracts locally (coinFlip.</description></item><item><title>5. Telephone</title><link>https://hakbrain.xyz/write-ups/ethernaut/telephone/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/ethernaut/telephone/</guid><description>diff between tx.origin &amp;amp; msg.sender msg.sender gives direct sender of the msg (user wallet or another smart contract) checks where the external function call directly came from tx.</description></item><item><title>Agent T</title><link>https://hakbrain.xyz/write-ups/thm/agent-t/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/agent-t/</guid><description>![[write-ups/images/Pasted image 20220807180318.png]]
So let&amp;rsquo;s check the web server:
At this point I let gobuster run in the background, while I fired-up burp &amp;amp; started browsing around the website: !</description></item><item><title>Alfred</title><link>https://hakbrain.xyz/write-ups/thm/alfred/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/alfred/</guid><description>Initial Foothold ![[write-ups/images/Pasted image 20220820235756.png]]
On 8080 I tried admin:admin and we are in due to default credentials. ![[write-ups/images/Pasted image 20220820230201.</description></item><item><title>attacking-kerberos</title><link>https://hakbrain.xyz/write-ups/thm/attacking-kerberos/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/attacking-kerberos/</guid><description>What is Kerberos ? Kerberos is the default authentication service for Microsoft Windows domains\ an authentication protocol, not authorization. It allows identification 4 each user, but doesn&amp;rsquo;t validate to which reources/services can the user access intented to be more secure than NTLM by using third party ticket authorization as well as stronger encryption several agents work together to provide authentication in Kerberos: Client/User who wants to access the service Application Server (AP) which offers the service required by the user Key Distribution Center (KDC): the main service, responsible of issuing the tickets, installed on the [AD &amp;ndash; Domain Controllers (DC)](.</description></item><item><title>autopsy</title><link>https://hakbrain.xyz/write-ups/thm/autopsy/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/autopsy/</guid><description>What is the full name of the operating system version? ![[write-ups/images/Pasted image 20220630063830.png]] What percentage of the drive are documents?</description></item><item><title>Biblioteca</title><link>https://hakbrain.xyz/write-ups/thm/Biblioteca/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/Biblioteca/</guid><description>Recon ![[write-ups/images/Pasted image 20220602213700.png]]
Going to the http server gets us this: ![[write-ups/images/Pasted image 20220813102932.png]] Thought about brute-forcing the login form, but since the box has this message: &amp;quot;Shhh.</description></item><item><title>Breaching Active Directory</title><link>https://hakbrain.xyz/write-ups/thm/breaching-active-directory/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/breaching-active-directory/</guid><description>Covers techniques to recover AD credentials in this network:
NTLM Authenticated Services LDAP Bind Credentials Authentication Relays Microsoft Deployment Toolkit Configuration Files We can use these techniques on a security assesment by targeting systems of an organisation that are internet-facing or by implanting a rogue device on the organisation&amp;rsquo;s network</description></item><item><title>committed</title><link>https://hakbrain.xyz/write-ups/thm/committed/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/committed/</guid><description>since we&amp;rsquo;re given access to the machine I got commited.zip through python&amp;rsquo;s http server: ubuntu: python -m http.server my machine: wget http://ip-addr/commited.</description></item><item><title>core-windows-processes</title><link>https://hakbrain.xyz/write-ups/thm/core-windows-processes/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/core-windows-processes/</guid><description>TaskManager add columns by right-click on column headers details good columns to add: Image path name &amp;amp; command line if the Image path name or Command line is not what it&amp;rsquo;s expected to be, then we can perform a deeper analysis on this process lacks certain important information when analyzing processes, such as parent process information where other utilities, such as Process Hacker and Process Explorer come to the rescue cmd-line equivalents: tasklist, Get-Process or ps (PowerShell), and wmic System &amp;ldquo;The System process (process ID 4) is the home for a special kind of thread that runs only in kernel mode a kernel-mode system thread.</description></item><item><title>Craft</title><link>https://hakbrain.xyz/write-ups/htb/craft/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/htb/craft/</guid><description>Recon After running nmap we get:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 # Nmap 7.</description></item><item><title>Disk Analysis Autopsy</title><link>https://hakbrain.xyz/write-ups/thm/disk-analysis-autopsy/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/disk-analysis-autopsy/</guid><description>What is the MD5 hash of the E01 image? ![[write-ups/images/Pasted image 20220630082254.png]] What is the computer account name?</description></item><item><title>Game Zone</title><link>https://hakbrain.xyz/write-ups/thm/game-zone/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/game-zone/</guid><description>Recon ![[write-ups/images/Pasted image 20220821112327.png]]
First noticed that httpd was not running the latest version 2.4.54 &amp;amp; was using 2.4.18, but didn&amp;rsquo;t find anything of value there.</description></item><item><title>History of Malware</title><link>https://hakbrain.xyz/write-ups/thm/history-of-malware/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/history-of-malware/</guid><description>Concepts of Malicious Software have been around since 1949, and one of the first known theories was created by John von Neumann who produced work detailing self-replicating computer programs he also devised the von Neumann architecture (how computers transfer data to hardware) Proven 22 years later (1971) by the Creeper worm which used ARPANET to transfer itself between computers only displaying &amp;quot;I'm the creeper, catch me if you can!</description></item><item><title>Investigating Windows</title><link>https://hakbrain.xyz/write-ups/thm/investigating-windows/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/investigating-windows/</guid><description>Whats the version and year of the windows machine? WinKey + R -&amp;gt; winver &amp;gt; Windows Server 2016 Which user logged in last?</description></item><item><title>ISAC</title><link>https://hakbrain.xyz/write-ups/thm/isac/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/isac/</guid><description>Information Sharing and Analysis Centers (ISACs), are used to share and exchange various Indicators of Compromise (IOCs: MD5s, Ips, YARA rules) to obtain threat intelligence</description></item><item><title>Jacob The Boss</title><link>https://hakbrain.xyz/write-ups/thm/jacob-the-boss/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/jacob-the-boss/</guid><description>Recon ![[write-ups/images/Pasted image 20220602213430.png]]
checking jacobtheboss.box on 80 gives us a dummy blog ![[write-ups/images/Pasted image 20220819064559.png]] tried sqli on index.</description></item><item><title>Kenobi</title><link>https://hakbrain.xyz/write-ups/thm/kenobi/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/kenobi/</guid><description>Recon ![[write-ups/images/nmap_scan_kenobi.png]]
Enumerating SMB Started with enum4linux or with nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse 10.10.83.28. That revealed an open share with anonymity login enabled which exposed a log.</description></item><item><title>Malware Intro</title><link>https://hakbrain.xyz/write-ups/thm/malware-intro/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/malware-intro/</guid><description>When analysing malware it&amp;rsquo;s important to consider the following:
Point of Entry (PoE): how did the malware ended up on your network (i.</description></item><item><title>MISP</title><link>https://hakbrain.xyz/write-ups/thm/misp/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/misp/</guid><description>MISP Overview Malware Information Sharing Platform is an open-source threat information platform that facilitates the collection, storage and distribution of threat intelligence and Indicators of Compromise (IOCs) related to malware, cyber attacks, financial fraud or any intelligence within a community of trusted members</description></item><item><title>Mr Robot</title><link>https://hakbrain.xyz/write-ups/thm/mr-robot/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/mr-robot/</guid><description>Recon ![[write-ups/images/Pasted image 20220823155358.png]]
Web Analysis If we go to the home page of the website, there&amp;rsquo;s some cool looking booting animation &amp;amp; then we have a lot of options to choose from !</description></item><item><title>Obscurity</title><link>https://hakbrain.xyz/write-ups/htb/obscurity/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/htb/obscurity/</guid><description>Enumeration I started with a simple nmap to get a basic overview:
1 nmap -sC -sV -oA nmap/obscurity 10.</description></item><item><title>OpenVAS</title><link>https://hakbrain.xyz/write-ups/thm/openvas/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/openvas/</guid><description>Write-up Install: docker run -d -p 443:443 --name openvas mikesplain/openvas
IMG of report
Scenario: you are assigned to a routine vulnerability management pipeline as a SOC analyst.</description></item><item><title>Overpass2 (hacked)</title><link>https://hakbrain.xyz/write-ups/thm/overpass-2---hacked/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/overpass-2---hacked/</guid><description>Analysing the PCAP of our threat actor filtered by HTTP ![[write-ups/images/Pasted image 20220823180028.png]] taking a look @ what was uploaded we see a php script spawning a reverse shell on port 4242 !</description></item><item><title>Post Exploitation Basics (Windows)</title><link>https://hakbrain.xyz/write-ups/thm/post-exploitation-basics/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/post-exploitation-basics/</guid><description>PowerView Enumeration start PS with bypass the exec policy (allows to easily run scripts): powershell -ep bypass load PowerView: .</description></item><item><title>Redline</title><link>https://hakbrain.xyz/write-ups/thm/redline/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/redline/</guid><description>Standard Collector Analysis What is the suspicious scheduled task that got created on the victim&amp;rsquo;s computer? ![[write-ups/images/Pasted image 20220628184747.</description></item><item><title>Relevant</title><link>https://hakbrain.xyz/write-ups/thm/Relevant/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/Relevant/</guid><description>Recon ![[write-ups/images/Pasted image 20220823222922.png]]
![[write-ups/images/Pasted image 20220823222939.png]]
Got creds through SMB 🥳 &amp;hellip; oh wait Running the smb-enum-shares script with nmap revealed the following shares:</description></item><item><title>Res</title><link>https://hakbrain.xyz/write-ups/thm/res/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/res/</guid><description>Recon nmap -sC -sV -oN scan.txt &amp;lt;ip&amp;gt; ![[write-ups/images/Pasted image 20220808101035.png]] While checking the website, I ran an all-port scan in the background: nmap -p- &amp;lt;ip&amp;gt; !</description></item><item><title>Road</title><link>https://hakbrain.xyz/write-ups/thm/road/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/road/</guid><description>Enumeration ![[write-ups/images/Pasted image 20220819191421.png]]
nmap gives us just 2 ports open: 80 and 22
Web Server ![[write-ups/images/Pasted image 20220819191517.png]] I let gobuster run in the background while browsing the website with burp open.</description></item><item><title>SkyNet</title><link>https://hakbrain.xyz/write-ups/thm/skynet/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/skynet/</guid><description>Enumeration ![[write-ups/images/Pasted image 20220822143023.png]]
for smb I ran enum4linux in the background ![[write-ups/images/Pasted image 20220822145222.png]] tried anonymous login &amp;amp; found this !</description></item><item><title>Splunk 2</title><link>https://hakbrain.xyz/write-ups/thm/splunk-2/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/splunk-2/</guid><description>BOTSv2 Github: https://github.com/splunk/botsv2
In this exercise, you assume the persona of Alice Bluebird, the analyst who successfully assisted Wayne Enterprises and was recommended to Grace Hoppy at Frothly (a beer company) to assist them with their recent issues.</description></item><item><title>Splunk101</title><link>https://hakbrain.xyz/write-ups/thm/splunk-101/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/splunk-101/</guid><description>Splunk is not only used for security; it&amp;rsquo;s used for data analysis, DevOps, etc Installing Splunk What is a SIEM ?</description></item><item><title>Steel Mountain</title><link>https://hakbrain.xyz/write-ups/thm/Steel-Mountain/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/Steel-Mountain/</guid><description>Recon ![[write-ups/images/Pasted image 20220821035650.png]]
on 80 we&amp;rsquo;re greeted with this =&amp;gt; we can answer &amp;ldquo;who&amp;rsquo;s the employee of the month&amp;rdquo; !</description></item><item><title>SysInternals</title><link>https://hakbrain.xyz/write-ups/thm/sysinternals/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/sysinternals/</guid><description>The Sysinternals tools is a compilation of over 70+ Windows-based tools which fall under the following categories:
File &amp;amp; Disk Utilities Networking Utilities Process Utilities Security Utilities System Information Miscellaneous These tools are popular amongst IT professionals who manage Windows systems.</description></item><item><title>SysMon</title><link>https://hakbrain.xyz/write-ups/thm/sysmon/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/sysmon/</guid><description>Overview most commonly used in conjuction w a security information &amp;amp; management system (SIEM) events are stored in Applications and Services Logs/Microsoft/Windows/Sysmon/Operational installation: powersshell: Download-SysInternalsTools C:\Sysinternals Sysmon binary from the Microsoft Sysinternals website download the Microsoft Sysinternal Suite staring it: Sysmon.</description></item><item><title>Time</title><link>https://hakbrain.xyz/write-ups/htb/time/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/htb/time/</guid><description>Overview This box is a Linux one. For the initial foothold you need to exploit a bug within the Jackson library for deserializing JSON&amp;rsquo;s leading to a SSRF which can leverage a RCE.</description></item><item><title>Volatility</title><link>https://hakbrain.xyz/write-ups/thm/volatility/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/volatility/</guid><description>Obtaining Memory Samples live machines (turned on) can have their memory captured with one of the following tools FTK Imager Redline DumpIt.</description></item><item><title>Windows Event Logs</title><link>https://hakbrain.xyz/write-ups/thm/windows-event-logs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/windows-event-logs/</guid><description>Event Viewer 1 2 3 4 5 6 7 8 9 10 11 12 # Get all powershell log events w id = 800 Get-EventLog &amp;#39;Windows Powershell&amp;#39; | Where-Object {$_.</description></item><item><title>Windows Forensics 1</title><link>https://hakbrain.xyz/write-ups/thm/windows-forensics-1/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/windows-forensics-1/</guid><description>Forensic Artifacts: are essential pieces of information that provide evidence of human activity (e.g during the investigation of a crime scene: fingerprints, tools used to perform the crime, etc are all considered forensic artifacts).</description></item><item><title>Windows Forensics 2</title><link>https://hakbrain.xyz/write-ups/thm/windows-forensics-2/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/windows-forensics-2/</guid><description>File Allocation Table (FAT) default file system for Microsoft since the late 70s creates a table that indexes the location of bits that are allocated to different files wiki page Data Structures Clusters: a basic storage unit of the FAT file system.</description></item><item><title>YARA</title><link>https://hakbrain.xyz/write-ups/thm/yara/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/yara/</guid><description>&amp;ldquo;The pattern matching swiss knife for malware researchers (and everyone else)&amp;rdquo;
YARA is a tool that can be used to identify files that meet certain conditions.</description></item><item><title>Zerologon</title><link>https://hakbrain.xyz/write-ups/thm/zerologon/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hakbrain.xyz/write-ups/thm/zerologon/</guid><description>NetLogon Protocol Overview is an RPC interface (Windows domain controllers) used 4 user and machine authentication (e.g logging in to servers using NTLM, update password) available over TCP through a dynamic port set by the portmapper service OR through an SMB pipe on 445 it uses a customized cryptographic protocol to let a client (a domain-joined computer) and server (the domain controller) prove to each other that they both know a shared secret (i.</description></item></channel></rss>