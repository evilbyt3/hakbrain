<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="CTI 101 CTI can be defined as evidence-based knowledge about adversaries, including their indicators, tactics, motivations, and actionable advice against them."><title>Intro to Cyber Threat Intel</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://hakbrain.xyz//icon.png><link href=https://hakbrain.xyz/styles.f40f9c8ac1c106641723dab5233fc67c.min.css rel=stylesheet><link href=https://hakbrain.xyz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://hakbrain.xyz/js/darkmode.8bfc78cc60cc5da6df81ec79c82c3775.min.js></script>
<script src=https://hakbrain.xyz/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://hakbrain.xyz/js/popover.abe6a51cc7138c5dff00f151dd627ad1.min.js></script>
<script src=https://hakbrain.xyz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://hakbrain.xyz/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://hakbrain.xyz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://hakbrain.xyz/",fetchData=Promise.all([fetch("https://hakbrain.xyz/indices/linkIndex.1ac0c85aa1d684a4101724d7a8dc7d65.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://hakbrain.xyz/indices/contentIndex.d72768815c3e27fe4b3137779d455392.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://hakbrain.xyz",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://hakbrain.xyz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/hakbrain.xyz\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://hakbrain.xyz/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://hakbrain.xyz/>üï∏Ô∏è H@kBr4in</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Intro to Cyber Threat Intel</h1><p class=meta>Last updated
Feb 7, 2023
<a href=https://github.com/vlagh3/hakbrain/tree/hugo/content/write-ups/thm/Intro%20to%20Cyber%20Threat%20Intel.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://hakbrain.xyz/tags/writeups/>Writeups</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#cti-101>CTI 101</a></li><li><a href=#classifications>Classifications</a></li><li><a href=#lifecycle>Lifecycle</a><ol><li><a href=#direction>Direction</a></li><li><a href=#collection>Collection</a></li><li><a href=#processing>Processing</a></li><li><a href=#analysis>Analysis</a></li><li><a href=#dissemination>Dissemination</a></li><li><a href=#feedback>Feedback</a></li></ol></li><li><a href=#standards--frameworks>Standards & Frameworks</a></li><li><a href=#tools>Tools</a></li><li><a href=#practical>Practical</a><ol><li><a href=#case-i>Case I</a></li><li><a href=#case-ii>Case II</a></li><li><a href=#case-iii>Case III</a></li></ol></li><li><a href=#refs>Refs</a></li><li><a href=#see-also>See Also</a></li></ol></nav></details></aside><a href=#cti-101><h2 id=cti-101><span class=hanchor arialabel=Anchor># </span>CTI 101</h2></a><p>CTI can be defined as evidence-based knowledge about adversaries, including their indicators, tactics, motivations, and actionable advice against them. These can be utilised to protect critical assets and inform cybersecurity teams and management business decisions.</p><ul><li><strong>Data:</strong>¬†Discrete indicators associated with an adversary such as IP addresses, URLs or hashes.</li><li><strong>Information:</strong>¬†A combination of multiple data points that answer questions such as ‚ÄúHow many times have employees accessed tryhackme.com within the month?‚Äù</li><li><strong>Intelligence:</strong>¬†The correlation of data and information to extract patterns of actions based on contextual analysis.</li></ul><p>The primary goal of CTI is to understand the relationship between your operational environment & your adversary:</p><ul><li>Who&rsquo;s attacking you?</li><li>What are their motivations?</li><li>What are their capabilities?</li><li>What artefacts and <a href=/sheets/Indicators-of-Compromise-IOCs rel=noopener class=internal-link data-src=/sheets/Indicators-of-Compromise-IOCs>sheets/Indicators of Compromise (IOCs)</a> should you look out for?</li></ul><p>With these questions, threat intelligence would be gathered from different sources</p><ul><li><strong>Internal</strong><ul><li>corporate security events & incident response reports</li><li>cyber awareness training reports</li><li>system logs & events</li></ul></li><li><strong>Community</strong><ul><li>open web forums</li><li>dark web communities for cybercriminals</li></ul></li><li><strong>External</strong><ul><li>threat intel feeds <em>(commercial / open-source)</em></li><li>online marketplaces</li><li>public sources <em>(government data, publications, social media, financial & industrial assessments)</em></li></ul></li></ul><a href=#classifications><h2 id=classifications><span class=hanchor arialabel=Anchor># </span>Classifications</h2></a><ul><li><strong>Strategic Intel</strong>: high-level intel that looks into an organization&rsquo;s threat landascape & maps out the risk areas based on trends, patterns & emerging threats that may impact buss decisions</li><li><strong>Technical Intel</strong>: looks into evidence / artefacts of attack used by an adversary. Incident reponse teams can use this data to create a baseline attack surface to analyze & develop defense mechanisms</li><li><strong>Tactical Intel</strong>: assesses adversaries&rsquo; tactics, techniques & procedures. This can strengthen security controls and address vulns through real-time investigations</li><li><strong>Operational Intel</strong>: looks into an adversary‚Äôs specific motives and intent to perform an attack. Security teams can use this intel to understand critical assets available in the organization <em>(people, processes, technologies)</em> that may be targeted</li></ul><a href=#lifecycle><h2 id=lifecycle><span class=hanchor arialabel=Anchor># </span>Lifecycle</h2></a><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/556cfb96c241e5260574a2e113f10305.png width=auto alt></p><a href=#direction><h3 id=direction><span class=hanchor arialabel=Anchor># </span>Direction</h3></a><p>Every threat intel program needs to have objectives defined, involving identifying the following params:</p><ul><li>information assets & buss procs that require defending</li><li>potential impact to be experienced on losing the assets or through process interruptions</li><li>sources of data to be used towards protection</li><li>tools & resources required to defend the assets</li></ul><p>This phase also allows security analysts to pose questions related to investigating incidents</p><a href=#collection><h3 id=collection><span class=hanchor arialabel=Anchor># </span>Collection</h3></a><p>Once objectives have been defined, security analysts will gather the required data to address them. Accomplished by using commercial, private and open-source resources available</p><blockquote><p>Note: Due to the volume of data analysts usually face, it&rsquo;s recommended to automate this phase as much as possible in order to provide time for triaging incidents</p></blockquote><a href=#processing><h3 id=processing><span class=hanchor arialabel=Anchor># </span>Processing</h3></a><p>Raw logs, vulnerability information, malware and network traffic usually come in different formats and may be disconnected when used to investigate an incident. This phase ensures that the data is extracted, sorted, organised, correlated with appropriate tags and presented visually in a usable and understandable format to the analysts. SIEMs are valuable tools for achieving this and allow quick parsing of data.</p><a href=#analysis><h3 id=analysis><span class=hanchor arialabel=Anchor># </span>Analysis</h3></a><p>Once the information aggregation is complete, security analysts must derive insights. Decisions to be made may involve:</p><ul><li>investigating a potential threat through uncovering indicators & attack patterns</li><li>defining an action plan to avert an attack & defend the infrastructure</li><li>strengthening security controls or justifying investment for additional resources</li></ul><a href=#dissemination><h3 id=dissemination><span class=hanchor arialabel=Anchor># </span>Dissemination</h3></a><p>Different organisational stakeholders will consume the intelligence in varying languages and formats. For example, C-suite members will require a concise report covering trends in adversary activities, financial implications and strategic recommendations. At the same time, analysts will more likely inform the technical team about the threat IOCs, adversary TTPs and tactical action plans.</p><a href=#feedback><h3 id=feedback><span class=hanchor arialabel=Anchor># </span>Feedback</h3></a><p>The final phase covers the most crucial part, as analysts rely on the responses provided by stakeholders to improve the threat intelligence process and implementation of security controls. Feedback should be regular interaction between teams to keep the lifecycle working.</p><a href=#standards--frameworks><h2 id=standards--frameworks><span class=hanchor arialabel=Anchor># </span>Standards & Frameworks</h2></a><ul><li><a class="internal-link broken">Mitre ATT&CK</a>:</li><li><a href=https://oasis-open.github.io/cti-documentation/taxii/intro rel=noopener>TAXII</a>:</li><li><a href=https://oasis-open.github.io/cti-documentation/stix/intro rel=noopener>STIX</a>:</li><li><a href=/write-ups/thm/Cyber-Kill-Chain rel=noopener class=internal-link data-src=/write-ups/thm/Cyber-Kill-Chain>write-ups/thm/Cyber Kill Chain</a></li><li><a href=/write-ups/thm/Diamond-Model rel=noopener class=internal-link data-src=/write-ups/thm/Diamond-Model>write-ups/thm/Diamond Model</a></li><li>Notable threat reports:
<a href=https://www.mandiant.com/resources rel=noopener>Mandiant</a>,¬†
<a href=https://www.recordedfuture.com/resources/global-issues rel=noopener>Recorded Future</a>¬†and¬†
<a href=https://cybersecurity.att.com/ rel=noopener>AT&TCybersecurity</a></li></ul><a href=#tools><h2 id=tools><span class=hanchor arialabel=Anchor># </span>Tools</h2></a><ul><li><a href=https://urlscan.io/ rel=noopener>urlscan.io</a>: automate the process of browsing and crawling through websites to record activities and interactions <em>(e.g domain registrars, http requests, ip, links, certs, ASN)</em></li><li><a href=https://abuse.ch/ rel=noopener>abuse.ch</a>: developed to identify and track malware and botnets through several operational platforms<ul><li><strong>Malware Bazaar:</strong>¬† A resource for sharing malware samples.</li><li><strong>Feodo Tracker:</strong>¬† A resource used to track botnet command and control (C2) infrastructure linked with Emotet, Dridex and TrickBot.</li><li><strong>SSL Blacklist:</strong>¬† A resource for collecting and providing a blocklist for malicious SSL certificates and JA3/JA3s fingerprints.</li><li><strong>URL Haus:</strong>¬† A resource for sharing malware distribution sites.</li><li><strong>Threat Fox:</strong>¬† A resource for sharing indicators of compromise (IOCs).</li></ul></li><li><a href=https://www.phishtool.com/ rel=noopener>PhishTool</a>: seeks to elevate the perception of <a class="internal-link broken">phishing</a> as a severe form of attack and provide a responsive means of email security. Through <a class="internal-link broken">email analysis</a>, sec teams can uncover email <a href=/sheets/Indicators-of-Compromise-IOCs rel=noopener class=internal-link data-src=/sheets/Indicators-of-Compromise-IOCs>sheets/Indicators of Compromise (IOCs)</a>, prevent breaches & provide <a class="internal-link broken">Forensics</a> reports that could be used in phishing containment and training engagement</li><li><a href=https://talosintelligence.com/ rel=noopener>Cisco Talos Intelligence</a>: ¬†provide actionable intelligence, visibility on indicators, and protection against emerging threats through data collected from their products <em>(check
<a href=https://www.talosintelligence.com/docs/Talos_WhitePaper.pdf rel=noopener>whitepaper</a> for more)</em><ul><li><strong>Threat Intelligence & Interdiction:</strong>¬†Quick correlation and tracking of threats provide a means to turn simple IOCs into context-rich intel.</li><li><strong>Detection Research:</strong>¬†Vulnerability and malware analysis is performed to create rules and content for threat detection.</li><li><strong>Engineering & Development:</strong>¬†Provides the maintenance support for the inspection engines and keeps them up-to-date to identify and triage emerging threats.</li><li><strong>Vulnerability Research & Discovery:</strong>¬†Working with service and software vendors to develop repeatable means of identifying and reporting security vulnerabilities.</li><li><strong>Communities:</strong>¬†Maintains the image of the team and the open-source solutions.</li><li><strong>Global Outreach:</strong>¬†Disseminates intelligence to customers and the security community through publications.</li></ul></li></ul><a href=#practical><h2 id=practical><span class=hanchor arialabel=Anchor># </span>Practical</h2></a><p><strong>Scenario</strong>: You are a¬†SOC¬†Analyst. Several suspicious emails have been forwarded to you from other coworkers. You must obtain details from each email to triage the incidents reported.</p><a href=#case-i><h3 id=case-i><span class=hanchor arialabel=Anchor># </span>Case I</h3></a><p>Uploading the file in <a class="internal-link broken">PhisTool</a> yields more digestible information:</p><p><img src="/write-ups/images/Pasted image 20230208022331.png" width=auto></p><p><strong>What organisation is the attacker trying to pose as in the email?</strong>
Seems like a quite deceptive built LinkedIn phising page masquerading as a notification email &ndash; giving it urgency</p><p><strong>What IOCs can be retrieved?</strong>
We can determine some <a href=/sheets/Indicators-of-Compromise-IOCs rel=noopener class=internal-link data-src=/sheets/Indicators-of-Compromise-IOCs>sheets/Indicators of Compromise (IOCs)</a> from <a class="internal-link broken">analysing the email</a>&rsquo;s header:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># retrieved from Email1.eml headers</span>
</span></span><span class=line><span class=cl>From: <span class=s2>&#34;Patrick Cook&#34;</span> &lt;darkabutla@sc500.whpservers.com&gt;
</span></span><span class=line><span class=cl>To: <span class=s2>&#34;cabbagecare@hotsmail.com&#34;</span> &lt;cabbagecare@hotsmail.com&gt;
</span></span><span class=line><span class=cl>Date: Tue, <span class=m>29</span> Mar <span class=m>2022</span> 15:39:22 +0000 <span class=o>(</span>UTC<span class=o>)</span>
</span></span><span class=line><span class=cl>Subject: You have <span class=m>5</span> new message
</span></span><span class=line><span class=cl>X-Sender-IP: 204.93.183.11   <span class=c1># Defanged: 204[.]93[.]183[.]11</span>
</span></span></code></pre></td></tr></table></div></div><p>I also used
<a href=https://app.phishtool.com rel=noopener>PhishTool</a> to get information in a more web user-friendly environment</p><p><img src="/write-ups/images/Pasted image 20230208023616.png" width=auto></p><p>One thing to note though is the absence of attachments which indicates that the user would get compromised by accessing an URL instead:</p><p><img src="/write-ups/images/Pasted image 20230208023738.png" width=auto></p><p>Further analysis on the domain, IP and servers associated with them must be done to identify <em>who is attacking us?</em>* <em>(possible threat actors)</em>.</p><p><strong>Can you scope the threat actor landscape using CTI tools?</strong></p><p>To dig deeper, we can use tools like
<a href=https://www.shodan.io/host/204.93.183.11 rel=noopener>Shodan</a> to see what ports & services are currently running. Also, uploading it in
<a href="https://talosintelligence.com/reputation_center/lookup?search=204.93.183.11" rel=noopener>Talos</a> might reveal even more intel about the attacker&rsquo;s capabilities</p><p><img src="/write-ups/images/Pasted image 20230208024309.png" width=auto></p><p>Taking a look at the <code>whois</code> lookup can reveal even more about the history @ associated domains <em>(our attacker&rsquo;s infrastructure)</em></p><p><img src="/write-ups/images/Pasted image 20230208024434.png" width=auto></p><a href=#case-ii><h3 id=case-ii><span class=hanchor arialabel=Anchor># </span>Case II</h3></a><p>You are a¬†SOC¬†Analyst. Several suspicious emails have been forwarded to you from other coworkers. You must obtain details from each email to triage the incidents reported.</p><p>Taking a look @ <code>Email2.eml</code>:</p><p><img src="/write-ups/images/Pasted image 20230208024908.png" width=auto></p><p>First thing is to note the <a href=/sheets/Indicators-of-Compromise-IOCs rel=noopener class=internal-link data-src=/sheets/Indicators-of-Compromise-IOCs>sheets/Indicators of Compromise (IOCs)</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>From: LeHuong-accounts@gmail.com  <span class=c1># used legitimate gmail acc to spread malware?</span>
</span></span><span class=line><span class=cl>To: chris.lyons@supercarcenterdetroit.com <span class=c1># victim</span>
</span></span><span class=line><span class=cl>Date: 08:14 pm, Dec 14th <span class=m>2017</span>
</span></span><span class=line><span class=cl>IP: 134<span class=o>[</span>.<span class=o>]</span>19<span class=o>[</span>.<span class=o>]</span>187<span class=o>[</span>.<span class=o>]</span><span class=m>230</span>
</span></span><span class=line><span class=cl>Domain: hyp07-nl-ams.gowhitelabel.com
</span></span></code></pre></td></tr></table></div></div><p>Looks like a simple invoice note on a payment <em>(prob trying to hide as an internal correspondence between departments)</em>. Given that there&rsquo;s no URL redirection, instead a ZIP file is attached</p><p><img src="/write-ups/images/Pasted image 20230208025345.png" width=auto></p><p><a href=https://www.virustotal.com/gui/file/435bfc4c3a3c887fd39c058e8c11863d5dd1f05e0c7a86e232c93d0e979fdb28/details rel=noopener>VirusTotal</a> is pretty confident this is stealer trojan. Also plugging it in
<a href=https://talosintelligence.com/sha_searches rel=noopener>Talos</a> awards it a 100 score of being malicious:</p><p><img src="/write-ups/images/Pasted image 20230208030206.png" width=auto></p><p>Downloading the file & trying to unzip it requires a password:
<img src="/write-ups/images/Pasted image 20230208025703.png" width=auto></p><a href=#case-iii><h3 id=case-iii><span class=hanchor arialabel=Anchor># </span>Case III</h3></a><p><img src="/write-ups/images/Pasted image 20230208030514.png" width=auto></p><p>Looking just like an inoffensive purchase order invoice, indicating the user to open <code>Sales_Receipt 5606.xls</code> containing macros:</p><p><img src="/write-ups/images/Pasted image 20230208030702.png" width=auto></p><p>Plugging the hashes in
<a href=https://www.virustotal.com/gui/file/b8ef959a9176aef07fdca8705254a163b50b49a17217a4ff0107487f59d4a35d rel=noopener>VirusTotal</a> &
<a href=https://talosintelligence.com/sha_searches rel=noopener>Talos</a> immediately gives us more red alerts</p><p><img src="/write-ups/images/Pasted image 20230208030924.png" width=auto></p><ul><li><a href="https://malshare.com/sample.php?action=detail&hash=e63deaea51f7cc2064ff808e11e1ad55" rel=noopener>sample download</a></li><li><a href=https://app.docguard.io/b8ef959a9176aef07fdca8705254a163b50b49a17217a4ff0107487f59d4a35d/results/dashboard rel=noopener>sandbox analysis</a></li></ul><p>Seems like we&rsquo;re dealing with the
<a href=https://attack.mitre.org/software/S0384/ rel=noopener>Dridex</a> banking trojan</p><blockquote><p>Note: ofc more in-depth analysis can be performed by analyzing the macro</p></blockquote><a href=#refs><h2 id=refs><span class=hanchor arialabel=Anchor># </span>Refs</h2></a><ul><li><a href=https://tryhackme.com/room/cyberthreatintel rel=noopener>room</a></li></ul><a href=#see-also><h2 id=see-also><span class=hanchor arialabel=Anchor># </span>See Also</h2></a><ul><li><a href=/write-ups/THM rel=noopener class=internal-link data-src=/write-ups/THM>write-ups/THM</a></li><li><a class="internal-link broken">Phising Module</a></li><li>htb forensics challenge analyzing macro</li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/write-ups/thm/OpenCTI/ data-ctx="write-ups/thm/Intro to Cyber Threat Intel" data-src=/write-ups/thm/OpenCTI class=internal-link>OpenCTI</a></li><li><a href=/write-ups/thm/SOC-Level-1-Path/ data-ctx="write-ups/thm/Intro to Cyber Threat Intel" data-src=/write-ups/thm/SOC-Level-1-Path class=internal-link>SOC Level 1 Path</a></li><li><a href=/write-ups/thm/yara/ data-ctx="threat intelligence" data-src=/write-ups/thm/yara class=internal-link>YARA</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://hakbrain.xyz/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Vl@gh3 using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, ¬© 2023</p><ul><li><a href=https://hakbrain.xyz/>Home</a></li><li><a href=https://twitter.com/vlaghe1>Twitter</a></li><li><a href=https://github.com/vlagh3>Github</a></li></ul></footer></div></div></body></html>