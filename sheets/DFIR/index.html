<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="DFIR 101 DFIR = Digital Forensics and Incident Response
The Need 4 DFIR  finding evidence of compromise in the network & differenciating between false alarms & actual incidents robustly remove the attacker, so their foothold & persistence from the network no longer remains identify the extent & timeframe of a breach (helps in comm w relevant stakeholders) finding the loopholes that lead to the breach."><title>DFIR</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://hakbrain.xyz//icon.png><link href=https://hakbrain.xyz/styles.f40f9c8ac1c106641723dab5233fc67c.min.css rel=stylesheet><link href=https://hakbrain.xyz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://hakbrain.xyz/js/darkmode.8bfc78cc60cc5da6df81ec79c82c3775.min.js></script>
<script src=https://hakbrain.xyz/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://hakbrain.xyz/js/popover.abe6a51cc7138c5dff00f151dd627ad1.min.js></script>
<script src=https://hakbrain.xyz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://hakbrain.xyz/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://hakbrain.xyz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://hakbrain.xyz/",fetchData=Promise.all([fetch("https://hakbrain.xyz/indices/linkIndex.1ac0c85aa1d684a4101724d7a8dc7d65.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://hakbrain.xyz/indices/contentIndex.d72768815c3e27fe4b3137779d455392.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://hakbrain.xyz",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://hakbrain.xyz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/hakbrain.xyz\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://hakbrain.xyz/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://hakbrain.xyz/>üï∏Ô∏è H@kBr4in</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>DFIR</h1><p class=meta>Last updated
Jan 30, 2023
<a href=https://github.com/vlagh3/hakbrain/tree/hugo/content/sheets/DFIR.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://hakbrain.xyz/tags/writeups/>Writeups</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#dfir-101>DFIR 101</a><ol><li><a href=#the-need-4-dfir>The Need 4 DFIR</a></li><li><a href=#who-performs-it>Who performs it?</a></li></ol></li><li><a href=#basic-concepts>Basic Concepts</a></li><li><a href=#tools>Tools</a></li><li><a href=#incident-response-process>Incident Response Process</a></li><li><a href=#refs>Refs</a></li><li><a href=#see-also>See Also</a></li></ol></nav></details></aside><a href=#dfir-101><h2 id=dfir-101><span class=hanchor arialabel=Anchor># </span>DFIR 101</h2></a><p>DFIR = Digital Forensics and Incident Response</p><a href=#the-need-4-dfir><h3 id=the-need-4-dfir><span class=hanchor arialabel=Anchor># </span>The Need 4 DFIR</h3></a><ul><li>finding evidence of compromise in the network & differenciating between false alarms & actual incidents</li><li>robustly remove the attacker, so their foothold & persistence from the network no longer remains</li><li>identify the extent & timeframe of a breach <em>(helps in comm w relevant stakeholders)</em></li><li>finding the loopholes that lead to the breach. What needs to be changed to prevent such events in the future?</li><li>understanding attacker behavior to pre-emptively block further intrusion attempts</li><li>sharing info about the threat with the community</li></ul><a href=#who-performs-it><h3 id=who-performs-it><span class=hanchor arialabel=Anchor># </span>Who performs it?</h3></a><p>As the name suggests, DFIR requires expertise in both:</p><ul><li>Digital Forensics - These professionals are experts in identifying forensic artifacts or evidence of human activity in digital devices</li><li>Incident Response - Incident responders are experts in cybersecurity and leverage forensic information to identify the activity of interest from a security perspective</li></ul><p>DFIR proffesionals combine the best of the both worlds to achieve their goals <em>(often combined because they are highly interdependent)</em>.</p><a href=#basic-concepts><h2 id=basic-concepts><span class=hanchor arialabel=Anchor># </span>Basic Concepts</h2></a><ul><li><strong>Artifacts</strong>: are pieces of evidence that point to an activity performed on a system. They&rsquo;re collected to support a hypothesis or claim about the attacker activity <em>(e.g windows registry keys modification 4 persistence)</em>. They can be collected from the Endpoint or Server&rsquo;s file system, memory or network activity.</li><li><strong>Evidence Preservation</strong>: when performing DFIR we must maintain the integrity of the evidence we&rsquo;re collecting. Any forensic analysis can contaminate the evidence. Thus, the evidence is first collected & write-protected, following to make a copy which is used for analysis. This ensures that our original evidence remains safe. So if our copy under investigation gets corrupted we can always return & make a new copy from the evidence we had preserved</li><li><strong>Chain of custody</strong>: another critical aspect of maintaining integrity is to make sure the evidence is kept in secure custody. Any person not related to the investigation must not possess the evidence, or it will raise questions about the integrity of the data which weakens the case being built by adding unknown variables that can&rsquo;t be solved <em>(e.g a hard drive image being transferred from the person who took the image to the person who will perform the analysis, gets into the hands of a person who is not qualified to handle such evidence)</em></li><li><strong>Order of volatility</strong>: digital evidence is often volatile <em>(i.e can be lost forever if not captured in time)</em>. Some sources are more volatile as compared to others: a hard drive is persistent storage and maintains data even if power is lost. In contrast RAM keeps data only as long as it remains powered on. Thus, it&rsquo;s vital to understand the order of volatility when performing DFIR: preserve the RAM before preserving the hard drive since we might lose data in the RAM if we don&rsquo;t prioritize it</li><li><strong>Timeline creation</strong>: now that we have collected the artifacts & maintained their integrity, we need to present them understandably to fully use the information contained in them. A timeline of events needs to be created for efficient & accurate analysis. This timeline of events puts all the activities in chronological order. Timeline creation provides perspective to the investigation and helps collate information from various sources to create a story of how things happened</li></ul><p><img src="/write-ups/images/Pasted image 20230130134050.png" width=auto></p><a href=#tools><h2 id=tools><span class=hanchor arialabel=Anchor># </span>Tools</h2></a><ul><li><a href=https://ericzimmerman.github.io/#!index rel=noopener>Eric Zimmerman&rsquo;s tools</a> - can see practical exemples in <a href=/write-ups/thm/windows-forensics-1 rel=noopener class=internal-link data-src=/write-ups/thm/windows-forensics-1>write-ups/thm/windows-forensics-1</a> & <a href=/write-ups/thm/windows-forensics-2 rel=noopener class=internal-link data-src=/write-ups/thm/windows-forensics-2>write-ups/thm/windows-forensics-2</a></li><li><a href=https://www.kroll.com/en/services/cyber-risk/incident-response-litigation-support/kroll-artifact-parser-extractor-kape rel=noopener>KAPE</a> - <a class="internal-link broken">todo/KAPE</a> room</li><li><a href=/write-ups/thm/autopsy rel=noopener class=internal-link data-src=/write-ups/thm/autopsy>write-ups/thm/autopsy</a></li><li><a href=/write-ups/thm/volatility rel=noopener class=internal-link data-src=/write-ups/thm/volatility>write-ups/thm/volatility</a></li><li><a href=/write-ups/thm/redline rel=noopener class=internal-link data-src=/write-ups/thm/redline>write-ups/thm/redline</a></li><li><a class="internal-link broken">Velociraptor</a></li></ul><a href=#incident-response-process><h2 id=incident-response-process><span class=hanchor arialabel=Anchor># </span>Incident Response Process</h2></a><p>Per
<a href=https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf rel=noopener>NIST</a>:</p><ol><li>Preparation</li><li>Detection & Analysis</li><li>Containment, Eradication & Recovery</li><li>Post-incident Activity</li></ol><p>Per
<a href=https://www.sans.org/white-papers/33901/ rel=noopener>SANS Incident Handler&rsquo;s handbook</a>:</p><ol><li><strong>Preparation</strong>: be4 an incident happens we need to be ready in case of an incident: having the required people, processes, and technology to prevent and respond to incidents</li><li><strong>Identification</strong>: An incident is identified through some indicators. These are further analyzed for False Positives, documented and communicated to the relevant stakeholders</li><li><strong>Containment</strong>: the incident is contained & efforts are made to limit its effects. There can be short-term and long-term fixes for containing the threat based on forensic analysis of the incident that will be a part of this phase</li><li><strong>Eradication</strong>: the threat is eradicated from the network. This has to be ensured by a proper forensic analysis to contain the threat before eradicating it: if the entry point of the threat actor into the network is not plugged, the threat will not be effectively eradicated, and the actor can gain a foothold again</li><li><strong>Recovery</strong>: once the threat is removed from the network, the services that had been disrupted are brought back as they were before the incident happened</li><li><strong>Lessons Learned</strong>: ¬†a review of the incident is performed, the incident is documented, and steps are taken based on the findings from the incident to make sure that the team is better prepared for the next time an incident occurs</li></ol><blockquote><p><strong>Note</strong>: summarized as the acronym PICERL, making them easy to remember</p></blockquote><a href=#refs><h2 id=refs><span class=hanchor arialabel=Anchor># </span>Refs</h2></a><ul><li><a href=https://tryhackme.com/room/introductoryroomdfirmodule rel=noopener>room</a></li></ul><a href=#see-also><h2 id=see-also><span class=hanchor arialabel=Anchor># </span>See Also</h2></a><ul><li><a href=/write-ups/THM rel=noopener class=internal-link data-src=/write-ups/THM>write-ups/THM</a></li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/write-ups/thm/SOC-Level-1-Path/ data-ctx=sheets/DFIR data-src=/write-ups/thm/SOC-Level-1-Path class=internal-link>SOC Level 1 Path</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://hakbrain.xyz/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Vl@gh3 using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, ¬© 2023</p><ul><li><a href=https://hakbrain.xyz/>Home</a></li><li><a href=https://twitter.com/vlaghe1>Twitter</a></li><li><a href=https://github.com/vlagh3>Github</a></li></ul></footer></div></div></body></html>